<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Details | ElectroTech</title>
    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <!-- Back Button -->
    <a href="index.html" class="back-home-btn"><i class="fas fa-arrow-left"></i> Back to Home</a>

    <!-- Navbar (Simplified) -->
    <nav class="navbar" style="position: sticky; top: 0;">
        <div class="logo">
            <h1>Electro<span>Tech</span>.</h1>
        </div>
        <div class="nav-icons">
            <i class="fas fa-search"></i>
            <div class="cart-trigger" style="position: relative; display: inline-block; cursor: pointer;">
                <i class="fas fa-shopping-cart"></i>
                <span id="cart-count"
                    style="position: absolute; top: -10px; right: -10px; background: var(--accent); color: white; font-size: 0.7rem; padding: 2px 6px; border-radius: 50%;">(0)</span>
            </div>
        </div>
    </nav>

    <main id="app">
        <!-- Details Section -->
        <section class="product-detail-container" id="product-detail">
            <!-- Injected by JS -->
            <div class="detail-gallery">
                <div class="loader">Loading...</div>
            </div>
            <div class="detail-info">
                <!-- Data here -->
            </div>
        </section>

        <!-- Related Products -->
        <section class="products related-section">
            <div class="section-header">
                <h3>You Might Also Like</h3>
            </div>
            <div class="product-grid" id="related-grid">
                <!-- Related products injected here -->
            </div>
        </section>
    </main>

    <!-- Cart Sidebar -->
    <div class="cart-overlay" id="cart-overlay"></div>
    <div class="cart-sidebar" id="cart-sidebar">
        <div class="cart-header">
            <h3>Your Cart <span class="cart-count-badge">(0)</span></h3>
            <button class="close-cart" id="close-cart"><i class="fas fa-times"></i></button>
        </div>
        <div class="cart-items" id="cart-items">
            <!-- Items injected here -->
            <div class="empty-cart-msg">Your cart is empty</div>
        </div>
        <div class="cart-footer">
            <div class="cart-total">
                <span>Total:</span>
                <span id="cart-total-price">$0</span>
            </div>
            <button class="btn btn-primary checkout-btn" onclick="window.location.href='cart.html'">Checkout</button>
        </div>
    </div>

    <footer>
        <p>&copy; 2026 ElectroTech. Premium Electronics Store.</p>
    </footer>

    <script src="data.js"></script>
    <script src="cart.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const productId = parseInt(urlParams.get('id'));

            const product = products.find(p => p.id === productId);
            const detailContainer = document.getElementById('product-detail');

            if (product) {
                // Render Product Details
                detailContainer.innerHTML = `
                    <div class="detail-gallery">
                        <div class="circle-bg" style="width: 80%; height: 80%;"></div>
                        <img src="${product.image}" alt="${product.name}" class="detail-img">
                    </div>
                    <div class="detail-info">
                        <span class="detail-category">${product.category}</span>
                        <h1>${product.name}</h1>
                        <span class="detail-price">$${product.price}</span>
                        <p class="detail-desc">${product.description} This product features state-of-the-art technology, premium build quality, and comes with a 2-year warranty. Perfect for enthusiasts and professionals alike.</p>
                        
                        <div class="detail-actions">
                            <button class="btn btn-primary" onclick="addToCartById(${product.id}); window.location.href='cart.html'">Buy Now</button>
                            <button class="btn btn-secondary" onclick="addToCartById(${product.id})"><i class="fas fa-shopping-cart"></i> Add to Cart</button>
                        </div>
                    </div>
                `;

                // Render Related Products (Filter out current, same category or random)
                const relatedGrid = document.getElementById('related-grid');
                const related = products.filter(p => p.id !== productId && p.category === product.category).slice(0, 3);

                // If not enough related by category, just add some others
                const fill = products.filter(p => p.id !== productId && p.category !== product.category).slice(0, 3 - related.length);
                const finalRelated = [...related, ...fill];

                finalRelated.forEach(p => {
                    relatedGrid.innerHTML += `
                         <div class="product-card" onclick="location.href='product.html?id=${p.id}'" style="cursor: pointer;">
                            <div class="card-img">
                                <img src="${p.image}" alt="${p.name}">
                            </div>
                            <div class="card-info">
                                <h4>${p.name}</h4>
                                <div class="price-row">
                                    <span class="price">$${p.price}</span>
                                </div>
                            </div>
                        </div>
                    `;
                });

            } else {
                detailContainer.innerHTML = `<h2>Product not found</h2><a href="index.html" class="btn btn-primary">Go Home</a>`;
            }
        });
    </script>
</body>

</html>
